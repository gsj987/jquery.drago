/**
 * jQuery Drago v0.1.0
 * A lightweight drag and resize plugin meant for editorial design
 * in the browser.
 *
 * Original author: @kuroi_kenshi (hostsamurai)
 * Licensed under the WTFPL http://sam.zoy.org/wtfpl/COPYING
 */(function(a,b){function e(){var c=b.createElement("div"),d=c.style;a.support.userSelect=d.WebkitUserSelect===""?"WebkitUserSelect":d.MozUserSelect===""?"MozUserSelect":d.userSelect===""?"userSelect":!1,a.support.userSelect&&a.support.userSelect!=="userSelect"&&(a.cssHooks.userSelect={get:function(b,c,d){return a.css(b,a.support.userSelect)},set:function(b,c){b.style[a.support.userSelect]=c}})}var c=function(b,c){this._$el=a(b),this.opts=c,this.init()};c.prototype.init=function(){var a=this._$el,b={height:a[0].offsetHeight,width:a[0].offsetWidth};a.data("drago",b),this.opts.resize&&a.css("resize")!=="both"&&a.css({resize:"both",overflow:"hidden"}),this.bindEvents()},c.prototype.drag=function(b,c){var d=a(this),e=d.data();e.height===d.height()&&e.width===d.width()&&d.css({left:c.x,top:c.y}),d.data({height:d[0].offsetHeight,width:d[0].offsetWidth})},c.prototype.showCSS=function(b){var c=a(this);if(c[0].style.left!==""&&c[0].style.top!==""){var d=a("<div/>"),e=a("<pre/>"),f=a("<a>x</a>",{href:"#"});d.css({background:"#fff",color:"#000",border:"1px solid gray",padding:18,position:"absolute",top:c.offset().top-50,left:c.offset().left+50,zIndex:100,fontFamily:"monospace"});var g="left: "+c[0].style.left+"; top: "+c[0].style.top+"; "+"width: "+c.width()+"px; height: "+c.height()+"px;";e.text(g),f.css({display:"inline",position:"absolute",top:2,right:5,fontFamily:"sans-serif",fontWeight:"bold"}).hover(function(b){a(this).css({cursor:"pointer",color:"red"})}).mouseout(function(b){a(this).css({color:"#000"})}).on("click",function(b){b.preventDefault(),c.trigger("drago.hide",{elem:a(this)})}),d.append(e).prepend(f).appendTo(c.offsetParent())}},c.prototype.hideCSS=function(b,c){a(c.elem).offsetParent().remove()},c.prototype.bindEvents=function(){this._$el.on("drago.drag",this.drag).on("drago.show",this.showCSS).on("drago.hide",this.hideCSS),this._$el.on("mousedown",{options:this.opts,ctx:this},this.events.mousedown).on("dblclick",function(b){a(this).trigger("drago.show")})};var d={};d.mousedown=function(b){var c=a(this);c.css({cursor:"move",userSelect:"none"});var e={dimensions:{x:parseInt(c.css("left")!=="auto"?c.css("left"):c.position().left),y:parseInt(c.css("top")!=="auto"?c.css("top"):c.position().top),pageX:b.pageX,pageY:b.pageY},options:b.data.options,context:b.data.ctx};c.on("mousemove",e,d.mousemove).on("dragstart",function(a){a.preventDefault()}).on("mouseup",e,d.mouseup)},d.mousemove=function(b){var c=b.data.dimensions,d=b.data.options,e=b.data.context,f=d.grid,g=c.x+b.pageX-c.pageX,h=c.y+b.pageY-c.pageY;if(d.snap===!0){var i=f.x*Math.round(g/f.x),j=f.y*Math.round(h/f.y);a(this).trigger("drago.drag",{x:i,y:j,ctx:e})}else a(this).trigger("drago.drag",{x:g,y:h,ctx:e})},d.mouseup=function(b,c){var d=a(this),e=b.data.context.opts,f=e.grid,g=e.snap?Math.round(d.offset().top/f.y)*f.y:d.offset().top;a(this).off("mousemove").offset({top:g})},c.prototype.events=d,a.fn.drago=function(b){return e(),b=a.extend({},a.fn.drago.options,b),this.each(function(d,e){a.data(this,"plugin_drago")||(a.data(this,"plugin_drago"),new c(this,b))})},a.fn.drago.options={grid:{x:20,y:20},snap:!0,resize:!0}})(jQuery,document);